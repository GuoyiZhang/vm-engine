<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.vm.user.dao.mapper.custom.CustomVmUsersLoginLogsMapper">
    <select id="getUserLoginLogs" resultMap="com.vm.user.dao.mapper.VmUsersMapper.VmUsersLoginLogsMap">
        SELECT *
        FROM vm_users
        where
        is_deleted = #{query.isDeleted}
        <if test="query != null and query.username != null and query.username != ''">
            and username LIKE concat('%',#{query.username},'%')
        </if>
        <if test="query != null and query.wellMatchedUsername != null and query.wellMatchedUsername != ''">
            and username = #{query.wellMatchedUsername}
        </if>
        <if test="page != null and page.orderBy != null and page.orderBy!='' and page.orderType != null and page.orderType!=''">
            order by ${page.orderBy} ${page.orderType}
        </if>
        <if test="page != null and page.start != null and page.size != null">
            limit #{page.start},#{page.size}
        </if>
    </select>
    <select id="getUserLoginLogsTotal" resultType="long">
        SELECT count(id)
        FROM vm_users
        where is_deleted = #{query.isDeleted}
        <if test="query != null and query.username != null and query.username != ''">
            and username LIKE concat('%',#{query.username},'%')
        </if>
        <if test="query != null and query.wellMatchedUsername != null and query.wellMatchedUsername != ''">
            and username = #{query.wellMatchedUsername}
        </if>

    </select>
</mapper>