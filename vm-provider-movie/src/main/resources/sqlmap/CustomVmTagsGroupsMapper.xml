<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.vm.movie.dao.mapper.custom.CustomVmTagsGroupsMapper">

    <!--**************************** 用户端mapper start ****************************-->
    <resultMap id="GetTagsGroupsWithTagsMap" type="com.vm.movie.dao.po.custom.CustomVmTagsGroups">
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="status" jdbcType="TINYINT" property="status"/>
        <result column="create_time" jdbcType="INTEGER" property="createTime"/>
        <result column="update_time" jdbcType="INTEGER" property="updateTime"/>
        <collection property="items" column="id" select="com.vm.movie.dao.mapper.custom.CustomVmTagsMapper.selectTagsIdAndNameByTagGroupId">

        </collection>
    </resultMap>
    <select id="getTagsGroupsWithTags" resultMap="GetTagsGroupsWithTagsMap">
        SELECT
            *
        FROM
            vm_tags_groups
        WHERE
            `status` = 1
            and is_deleted = 1
    </select>
    <!--**************************** 管理端mapper end ****************************-->
    <select id="getTagGroups" resultMap="com.vm.movie.dao.mapper.VmTagsGroupsMapper.VmTagsGroupsMap">
        SELECT
        *
        FROM
        vm_tags_groups
        WHERE
        is_deleted = #{query.isDeleted}
        <if test="query != null and query.name != null and query.name != ''">
            `name` like concat('%',#{query.name},'%')
        </if>
        <if test="page != null and page.orderBy != null and page.orderBy!='' and page.orderType != null and page.orderType!=''">
            order by ${page.orderBy} ${page.orderType}
        </if>
        <if test="page != null and page.start != null and page.size != null">
            limit #{page.start},#{page.size}
        </if>
    </select>
    <select id="getTagGroupsTotal" resultType="long">
        SELECT
        count(id)
        FROM
        vm_tags_groups
        WHERE
        is_deleted = #{query.isDeleted}
        <if test="query != null and query.name != null and query.name != ''">
            `name` like concat('%',#{query.name},'%')
        </if>

    </select>

</mapper>